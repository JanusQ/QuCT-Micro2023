from qiskit import QuantumCircuit, execute, Aer
from qiskit.quantum_info import Operator
import numpy as np
from qiskit.circuit.random import random_circuit

def matrix(circuit):
    return Operator(circuit).data

rc1 = random_circuit(2, 2, measure=False)
rc2 = random_circuit(2, 2, measure=False)

irc1 = rc1.inverse()
rc3 = rc1.compose(rc2)

print(np.around(matrix(rc2)))
print(np.around(matrix(rc3) @ matrix(irc1), 2))
print(np.allclose(matrix(rc2), matrix(rc3) @ matrix(rc1).T.conj()))
print(np.allclose(matrix(rc1).T.conj(), matrix(irc1)))

# Create the circuit
c1 = QuantumCircuit(2)
c1.h(0)
c1.h(1)

ic1 = c1.inverse()
c1.cx(0, 1)

c2 = QuantumCircuit(2)
c2.cx(0, 1)


print(matrix(c2))
print(np.around(matrix(c1) @ matrix(ic1), 2))

